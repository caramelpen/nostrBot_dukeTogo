### 3-2.autoReply.js

#### 大前提として、以降の動作はこのbotをフォローしている人にのみ行います（管理者にはいつでも動作します）
#### 作動内容の概要図は以下になります
| No. | 反応語句 | 反応元投稿者 | 投稿内に固有設定値 | 作動確率 | 作動内容 |
|:-:|:-:|:-:|:-:|:-:|:-:|
| 1 | 発見 | 管理者 | (発見有無関係なし) | 100% | リプライ |
| 2 | 発見 | 一般 | 反応語句の前方に発見 | 100% | リプライ |
| 3 | 発見 | 一般 | 反応語句の前方に未発見 | ※B ※C | ※B リプライ  ※C リアクション |
| 4 | 未発見 | 管理者 | 発見 | 100% | リプライ(※D) |
| 5 | 未発見 | 管理者 | 発見(※A) | 100% | リアクション or リアクションとリプライ (※E) |
| 6 | 未発見 | 一般 | 発見(※A) | 100% | リアクション or リアクションとリプライ (※E) |

(※A)設定値がポスト内のどこかに存在するのではなく、ポストが設定値そのものの完全一致  
(※B)各反応語句に設定された確率  
(※C)各反応語句に設定された確率の倍  
(※D)全反応語句に設定されたリプライ語句全てからランダム  
(※E)リアクションカスタム絵文字の設定からランダムで取得したカスタム絵文字が規定絵文字なら規定絵文字を使用したリアクションのみ、カスタム絵文字ならその絵文字でリアクションとリプライ

### 詳細
- 3-2-1.フィードを購読し、配列で設定してある`autoReply.json`の`orgPost`プロパティに設定された語句をフィードに「発見」(No.1～3)  
  - 1.`.env`ファイルの`admin_HEX_PUBKEY`(HEX値で設定してください) に設定した管理者の公開鍵のポストに対する反応なら、`autoReaction.json`の`nativeWords`プロパティに設定してある語句の有無に関係なく、`autoReply.json`の `replyPostChar`プロパティからランダム(※1)でリプライ語句を決定しリプライします

  - 2.管理者以外のポストに対する反応の場合、反応語句の前方に`autoReaction.json`の`nativeWords`プロパティの設定値を発見すると、`autoReply.json`の`replyPostChar`プロパティからランダム(※1)でリプライ語句を決定しリプライします

  - 3.管理者以外のポストに対する反応の場合、反応語句の前方に`autoReaction.json`の`nativeWords`プロパティの設定値が発見できないと、`autoReply.json`の`probability`プロパティに設定された確率を満たした時に限り、対応する配列で設定された`autoReply.json`の`replyPostChar`プロパティからランダム(※1)でリプライ語句を決定しリプライします
  - 3.において確率を満たせなかった場合は、その確率の倍で再度判定を行い、満たせば配列で設定してある`autoReaction.json`の`contentReaction`プロパティからランダム(※1)でリアクションするカスタム絵文字を取得し、その取得した要素番目に対応する`autoReaction.json`の`reactionImgURL`が設定してあるならその`reactionImgURL`でリアクションします（`reactionImgURL`に値が設定されているか100回繰り返し、設定された`reactionImgURL`を取得できた時点で繰り返しを終了します　100回繰り返しても`reactionImgURL`を取得できなければリアクションは行いません）


- 3-2-2.フィードを購読し、配列で設定してある`autoReply.json`の`orgPost`プロパティに設定された語句をフィードから「未発見」(No.4～6)
  - 4.`.env`ファイルの`admin_HEX_PUBKEY`(HEX値で設定してください) に設定した管理者の公開鍵のポストであり、`autoReaction.json`の`nativeWords`プロパティに設定してある語句を含むポストなら、`autoReply.json`の全`replyPostChar`からランダム(※1)でリプライ語句を決定しリプライします

  - 5.`.env`ファイルの`admin_HEX_PUBKEY`(HEX値で設定してください) に設定した管理者の公開鍵のポストであり、`autoReaction.json`の`nativeWords`プロパティに設定してある語句そのもののポストなら、配列で設定してある`autoReaction.json`の`contentReaction`プロパティからランダム(※1)でリアクションするカスタム絵文字を取得し、その取得した要素番目に対応する`autoReaction.json`の`reactionImgURL`プロパティでリアクションし、さらに`autoReaction.json`の`reactionImgURL`プロパティを使用してリプライも行います  
※上記には例外があり、`autoReaction.json`の`contentReaction`プロパティがカスタム絵文字コードではなく既存絵文字を設定している場合は、`autoReaction.json`の`reactionImgURL`プロパティは未設定とし、リアクションは行わず、その絵文字でのリプライのみ行います

  - 6.管理者以外のポストであり、`autoReaction.json`の`nativeWords`プロパティに設定してある語句そのもののポストなら、5.に同じとなります

- 一度のポストに複数の反応語句があった場合はjsonの記述順で初めにヒットした`orgPost`の反応語句が対象になります

##### ※1について
- `README.md`の 4-2. をご覧ください
